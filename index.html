<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<title>Índices Moveleiro — Modern Dashboard v3.8</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
:root {
  --bg: #dfe1e1;
  --card: #ffffff;
  --shadow: 0 3px 10px rgba(0,0,0,0.08);
  --title-bg: #000000;
  --title-fg: #ffffff;
  --accent: #f5b95f;
}
body {
  background: var(--bg);
  color:#111;
  font-family: Inter, Arial, sans-serif;
  margin:24px;
}
h1, h2 { margin: 0; }
section { margin-bottom: 34px; }
.titlebar {
  background: var(--title-bg);
  color: var(--title-fg);
  padding: 10px 16px;
  border-radius: 6px 6px 0 0;
  font-weight: 600;
  letter-spacing: .2px;
}
.card {
  background: var(--card);
  box-shadow: var(--shadow);
  border-radius: 0 0 10px 10px;
  padding: 16px;
}
.controls {
  display:flex;
  gap:10px;
  align-items:center;
  margin: 12px 0 8px 0;
  flex-wrap: wrap;
}
.status {
  margin-left:auto;
  font-size:12px;
  color:#333;
  background:#fff;
  padding:6px 10px;
  border:1px solid #e5e5e5;
  border-radius:8px;
}
input[type=date], button {
  padding: 8px 12px;
  border-radius:8px;
  border:1px solid #e5e5e5;
}
button { background:#f7f7f7; cursor:pointer; }
#chartGeral { width:100%; height:600px; }
#chartCRC, #chartIron, #chartFreight, #chartFX { width:100%; height:460px; }
.qgrid {
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:16px;
  margin:12px 0 8px 0;
}
.year-block {
  background:#f8f9fb;
  border-left:6px solid var(--accent);
  padding:10px 14px;
  border-radius:8px;
  box-shadow: var(--shadow);
}
.year-title { font-weight:600; margin-bottom:6px; color:#222; }
.last-month.left { margin-top:10px; color:#111; font-weight:600; }
.small { color:#666; font-size:12px; }
</style>
</head>
<body>

<section id="geral">
  <div class="titlebar">Índices Moveleiro</div>
  <div class="card">
    <div class="controls">
      <label>Data inicial: <input type="date" id="start"></label>
      <label>Data final: <input type="date" id="end"></label>
      <button id="apply">Aplicar filtro</button>
      <button id="download">Baixar CSV</button>
      <span id="info" class="small"></span>
      <span id="status" class="status"></span>
    </div>
    <div id="chartGeral"></div>
  </div>
</section>

<section id="crc">
  <div class="titlebar">Aço CRC China (USD/TON)</div>
  <div class="card">
    <div id="chartCRC"></div>
  </div>
</section>

<section id="iron">
  <div class="titlebar">Minério de Ferro (USD/TON)</div>
  <div class="card">
    <div id="chartIron"></div>
  </div>
</section>

<section id="freight">
  <div class="titlebar">Frete Marítimo (USD/TEU)</div>
  <div class="card">
    <div id="chartFreight"></div>
  </div>
</section>

<section id="fx">
  <div class="titlebar">Taxas de Câmbio (USD/BRL e USD/CNY)</div>
  <div class="card">
    <div id="chartFX"></div>
  </div>
</section>

<script>
// ⚙️ Substitua os dados abaixo pelos seus próprios dados (gerados no CSV)
const RAW = {
  date: ["2024-02-26","2024-03-11","2024-03-25","2024-04-08","2024-04-22","2024-05-13","2024-05-27","2024-06-10","2024-06-24","2024-07-08","2024-07-22","2024-08-12","2024-08-26","2024-09-09","2024-09-23","2024-10-14","2024-10-28","2024-11-11","2024-11-25","2024-12-09","2024-12-23","2025-01-13","2025-01-27","2025-02-10","2025-02-24","2025-03-10","2025-03-24","2025-04-14","2025-04-28","2025-05-12","2025-05-26","2025-06-09","2025-06-23","2025-07-14","2025-07-28","2025-08-11","2025-08-25","2025-09-08","2025-09-22","2025-10-13"],
  crc: [561,558,554,550,552,557,560,563,569,575,578,580,576,572,565,560,556,554,550,546,542,540,542,545,548,551,553,556,559,563,565,568,570,574,576,580,584,589,592,595],
  iron: [113.89,114.33,113.01,112.75,112.54,111.90,111.46,111.12,110.85,110.44,110.02,109.60,109.12,108.77,108.40,108.11,107.94,107.66,107.44,107.30,107.10,106.95,106.84,106.72,106.55,106.43,106.38,106.26,106.15,106.08,106.00,105.93,105.88,105.81,105.74,105.66,105.59,105.55,105.49,105.45],
  freight: [2315,2300,2290,2280,2270,2260,2250,2240,2230,2220,2210,2200,2190,2180,2170,2160,2150,2140,2130,2120,2110,2100,2090,2080,2070,2060,2050,2040,2030,2020,2010,2000,1990,1980,1970,1960,1950,1940,1930,1920],
  usdbrl: [4.98,4.97,5.00,5.02,5.05,5.08,5.10,5.12,5.13,5.14,5.16,5.18,5.20,5.22,5.24,5.26,5.28,5.30,5.31,5.33,5.34,5.35,5.36,5.37,5.38,5.39,5.40,5.41,5.42,5.43,5.44,5.45,5.46,5.47,5.48,5.49,5.50,5.51,5.52,5.53],
  usdcny: [7.12,7.13,7.14,7.15,7.16,7.18,7.19,7.20,7.21,7.22,7.23,7.24,7.25,7.26,7.27,7.28,7.29,7.30,7.31,7.32,7.33,7.34,7.35,7.36,7.37,7.38,7.39,7.40,7.41,7.42,7.43,7.44,7.45,7.46,7.47,7.48,7.49,7.50,7.51,7.52]
};

function monthTicks(dates) {
  const PT_ABBR = ["JAN","FEV","MAR","ABR","MAI","JUN","JUL","AGO","SET","OUT","NOV","DEZ"];
  const seen = new Set(), tickvals=[], ticktext=[];
  for(let i=0;i<dates.length;i++){
    const dt=new Date(dates[i]);
    const key=dt.getFullYear()+"-"+(dt.getMonth()+1);
    if(!seen.has(key)){
      seen.add(key);
      tickvals.push(dates[i]);
      ticktext.push(PT_ABBR[dt.getMonth()]);
    }
  }
  return {tickvals,ticktext};
}

function drawAll(){
  const {tickvals,ticktext}=monthTicks(RAW.date);
  const lineCfg=(color)=>({
    mode:'lines+markers',
    line:{shape:'spline',smoothing:0.6,width:2.2,color:color},
    marker:{size:8,line:{width:1,color:'#fff'}}
  });

  // Gráfico geral
  Plotly.newPlot('chartGeral',[
    {x:RAW.date,y:RAW.crc,name:'Aço CRC China (USD/TON)',...lineCfg('#007bff')},
    {x:RAW.date,y:RAW.iron,name:'Minério de Ferro (USD/TON)',...lineCfg('#ff6f00')},
    {x:RAW.date,y:RAW.freight,name:'Frete Marítimo (USD/TEU)',...lineCfg('#00bfa6')}
  ],{
    hovermode:'x unified',
    legend:{orientation:'h',y:1.12},
    xaxis:{tickmode:'array',tickvals:tickvals,ticktext:ticktext},
    yaxis:{title:'USD/TON',gridcolor:'#e9ecef',zeroline:false},
    paper_bgcolor:'#fff',plot_bgcolor:'#fff'
  });

  // Câmbio com eixos independentes
  Plotly.newPlot('chartFX',[
    {x:RAW.date,y:RAW.usdbrl,name:'USD/BRL',...lineCfg('#7e57c2'),yaxis:'y1'},
    {x:RAW.date,y:RAW.usdcny,name:'USD/CNY',...lineCfg('#e53935'),yaxis:'y2'}
  ],{
    hovermode:'x unified',
    legend:{orientation:'h',y:1.12},
    xaxis:{tickmode:'array',tickvals:tickvals,ticktext:ticktext},
    yaxis:{title:'USD/BRL',gridcolor:'#e9ecef',zeroline:false},
    yaxis2:{title:'USD/CNY',overlaying:'y',side:'right',showgrid:false},
    paper_bgcolor:'#fff',plot_bgcolor:'#fff'
  });

  // Outros gráficos
  Plotly.newPlot('chartCRC',[{x:RAW.date,y:RAW.crc,name:'Aço CRC China (USD/TON)',...lineCfg('#007bff')}],
    {xaxis:{tickvals:tickvals,ticktext:ticktext},yaxis:{title:'USD/TON',gridcolor:'#e9ecef',zeroline:false}});
  Plotly.newPlot('chartIron',[{x:RAW.date,y:RAW.iron,name:'Minério de Ferro (USD/TON)',...lineCfg('#ff6f00')}],
    {xaxis:{tickvals:tickvals,ticktext:ticktext},yaxis:{title:'USD/TON',gridcolor:'#e9ecef',zeroline:false}});
  Plotly.newPlot('chartFreight',[{x:RAW.date,y:RAW.freight,name:'Frete Marítimo (USD/TEU)',...lineCfg('#00bfa6')}],
    {xaxis:{tickvals:tickvals,ticktext:ticktext},yaxis:{title:'USD/TEU',gridcolor:'#e9ecef',zeroline:false}});
}

drawAll();
</script>

</body>
</html>

